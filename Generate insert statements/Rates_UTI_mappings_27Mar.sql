set nocount on

declare @UTIMapping_27Mar table ([TradeIdType] VARCHAR(400), [PublisherTradeId] VARCHAR(400), [UTI] VARCHAR(400), [UTIPrefix] VARCHAR(400))

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('qaBookDealId', 'me008c3d', '1030209452', '1001ME008C3DZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('fiTmsTradeId', 'tky009de177', '1030209452', '10119092340BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('fiTmsTradeId', 'tky0091eb26', '1030209452', '10119066736BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('fiTmsTradeId', 'ldn02ba4f32', '1030209452', '10117884471BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('fiTmsTradeId', 'tky0095b7df', '1030209452', '10119074662BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('fiTmsTradeId', 'ldn02d54542', '1030209452', '101120505300BZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('fiTmsTradeId', 'tky008df20c', '1030209452', '10119057269BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('fiTmsTradeId', 'tky0095b7de', '1030209452', '10119074661BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('fiTmsTradeId', 'tky0091eb27', '1030209452', '10119066769BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('fiTmsTradeId', 'ldn02d54798', '1030209452', '101120504996BZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('fiTmsTradeId', 'tky00a90b10', '1030209452', '10119113304BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('qaBookDealId', 't0045be2', '1030209452', '1001T0045BE2ZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('fiTmsTradeId', 'ldn018b4d60', '1030209452', '10117046275BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml0040ffd2', '1030209452', '10114405109BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml000b4e62', '1030209452', '10112772474BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml005e71b8', '1030209452', '10114679586BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml00150205', '1030209452', '10113682551BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml00127c50', '1030209452', '10113491598BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'ems000bf3a0', '1030209452', '101113001893BZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml003658a3', '1030209452', '10114259419BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml0023f7e0', '1030209452', '10114010740BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'ems000be8ad', '1030209452', '10116126945BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'ems00018457', '1030209452', '10113694094BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml005447f2', '1030209452', '10114621068BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml009d594a', '1030209452', '10114972257BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml005dfc12', '1030209452', '10114676748BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml0080c6e8', '1030209452', '10114853230BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'ems0000c5ac', '1030209452', '10113242750BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'ems000bdaf9', '1030209452', '10116124471BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml009d343c', '1030209452', '10114971840BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml0040d4a1', '1030209452', '10114402958BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml00146b5b', '1030209452', '10113640404BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml00547134', '1030209452', '10114621664BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'ems000bd7bc', '1030209452', '10116123825BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'ems0009e03c', '1030209452', '10116932757BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml00463121', '1030209452', '10114467685BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml00656fbe', '1030209452', '10114726606BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'ems00089901', '1030209452', '10116880206BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml0094dc9c', '1030209452', '10114933482BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'ems0005b1a9', '1030209452', '10116766144BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml006442ea', '1030209452', '10114718554BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml00825d2f', '1030209452', '10114859517BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'ems0000c940', '1030209452', '10113275014BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml00107b56', '1030209452', '10113348271BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml000c7b16', '1030209452', '10112963436BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml0078db8d', '1030209452', '10114818455BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml0094fbf4', '1030209452', '10114934042BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml001a186f', '1030209452', '10113883228BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml006442bd', '1030209452', '10114718549BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml00244d57', '1030209452', '10114014432BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml00241e92', '1030209452', '10114012415BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml008b6ac0', '1030209452', '10114894917BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml0012b749', '1030209452', '10113509376BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'ems000bccbf', '1030209452', '10116122438BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml000c5f82', '1030209452', '10112947321BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml00155e77', '1030209452', '10113708972BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml0040ffcf', '1030209452', '10114405107BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml00825d2c', '1030209452', '10114859621BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml009d3a98', '1030209452', '10114971893BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'ems0005a206', '1030209452', '10116763328BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('emTmsTradeId', 'eml0036917e', '1030209452', '10114263308BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('fiTmsTradeId', 'ldn02a4a8ee', '1030209452', '10117808711BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('fiTmsTradeId', 'ldn01e1f073', '1030209452', '10117239336BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('fiTmsTradeId', 'nyk0d825b3a', '1030209452', '10118084275BZZZZZZZZZZZZZZZZZZZZ');
INSERT INTO @UTIMapping_27Mar([TradeIdType],[PublisherTradeId],[UTIPrefix],[UTI]) VALUES ('fiTmsTradeId', 'ldn014848db', '1030209452', '10113503035BZZZZZZZZZZZZZZZZZZZZ');

declare @count int
select @count = count(*) from @UTIMapping_27Mar
print 'Processed '+cast(@count as varchar(100))+' total records'

MERGE srf_main.UTIMapping AS U
USING ( SELECT  PublisherTradeID,	TradeIdType,	UTI,[UTIPrefix] AS utiprefix from @UTIMapping_27Mar)AS T 
ON U.TradeIdType=T.TradeIdType AND U.PublisherTradeId=T.PublisherTradeId 
WHEN MATCHED THEN 
UPDATE SET U.UTI=T.UTI,U.UtiPrefix=T.UTIPrefix
WHEN NOT MATCHED by Target THEN
INSERT (TradeIdType,PublisherTradeId,UTIPrefix,UTI)
VALUES(T.TradeIdType,T.PublisherTradeId,T.UTIPrefix,T.UTI)
OUTPUT $action, Inserted.*, Deleted.*; 

